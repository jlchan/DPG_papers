%% primal rate 1e0
A = {}

h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
energy_err =  [0.74600249141875097, 0.35303148623880815, 0.16483657484490652, 0.07925751806697226, 0.03887355522967758, 0.019256951058568228]
L2_err =  [0.03241444583995088, 0.015117293759873663, 0.0047920688094868292, 0.0013409668894764366, 0.00035665455906727856, 9.2268022656046708e-05]
A{1} = [1*ones(size(h')) h' L2_err'];

h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625]
energy_err =  [0.074997319897159784, 0.017295647732800328, 0.0041604347086731759, 0.0010202801793126669, 0.00025258307639340399]
L2_err =  [0.0036043048393879446, 0.00042742445374704892, 5.1275185170760438e-05, 6.253449744554639e-06, 7.7109915673857707e-07]
A{2} = [2*ones(size(h')) h' L2_err'];

h =  [0.25, 0.125, 0.0625, 0.03125]
energy_err =  [0.0053383506475036605, 0.00062593069418418379, 7.4452825073672224e-05, 9.0297950822033066e-06]
L2_err =  [0.0001364384032054282, 8.690410743389799e-06, 5.3695899582540938e-07, 3.3188859091347267e-08]
A{3} = [3*ones(size(h')) h' L2_err'];

% h =  [0.25, 0.125, 0.0625]
% energy_err =  [0.00028572301407602581, 1.6201073296293137e-05, 9.4734594730248863e-07]
% L2_err =  [5.9350884647727641e-06, 1.7974434756025204e-07, 4.9677590560542353e-09]
h =  [0.25, 0.125, 0.0625]
energy_err =  [0.0003105489874564789, 1.7947088290791588e-05, 1.0608770045985049e-06]
L2_err =  [6.0293069129179496e-06, 1.8308602423361749e-07, 2.1105963903123947e-09]
A{4} = [4*ones(size(h')) h' L2_err'];
% h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
% dofs =  [25, 81, 289, 1089, 4225, 16641]
% energy_err =  [0.62391839695812079, 0.27093198852142186, 0.11860978890966004, 0.054647643588877838, 0.026156972983391931, 0.012791295947786704]
% L2_err =  [0.03884100820757376, 0.016230434202282751, 0.0049134167765656359, 0.0013464562177553348, 0.00035394684827656819, 9.0969768291178157e-05]
% 

figure
plot_rates(A)
print(gcf,'-depsc','primal_eps1e0.eps')

%% plotting mixed rates 1e0

A = {};
B = {};
%p = 1
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
dofs =  [25, 81, 289, 1089, 4225, 16641]
energy_err =  [0.62391839695812079, 0.27093198852142186, 0.11860978890966004, 0.054647643588877838, 0.026156972983391931, 0.012791295947786704]
L2_err =  [0.03884100820757376, 0.016230434202282751, 0.0049134167765656359, 0.0013464562177553348, 0.00035394684827656819, 9.0969768291178157e-05]

A{1} = [1*ones(size(h')) h' L2_err'];
B{1} = [1*ones(size(h')) h' energy_err'];
%p = 2
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
dofs =  [81, 289, 1089, 4225, 16641, 66049]
energy_err =  [0.060187416538340283, 0.013358670594367367, 0.0031721466220019012, 0.00077438034042302231, 0.00019136277159742001, 4.7565968185844156e-05]
L2_err =  [0.0035834750819825245, 0.00042124666571577424, 5.0719362247134368e-05, 6.2104951756273304e-06, 7.6766236395386215e-07, 9.5391014605337451e-08]
A{2} = [2*ones(size(h')) h' L2_err']
A{2} = A{2}(1:end-1,:);
B{2} = [2*ones(size(h')) h' energy_err'];
%p = 3
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625]
dofs =  [169, 625, 2401, 9409, 37249, 148225]
energy_err =  [0.0046347373695893711, 0.00053405163861271036, 6.2651674655232335e-05, 7.5304530812761273e-06, 9.2102469704809195e-07]
L2_err =  [0.0001353120677942511, 8.6431035919911085e-06, 5.355027608378427e-07, 3.3309862662314273e-08, 2.0001083145653167e-09]
A{3} = [3*ones(size(h')) h' L2_err']
A{3} = A{3}(1:end-1,:);

B{3} = [3*ones(size(h')) h' energy_err'];

%p = 4
h =  [0.25, 0.125, 0.0625]
dofs =  [289, 1089, 4225]
energy_err =  [0.00028462978847489779, 1.6155890352102114e-05, 9.4580571908709627e-07]
L2_err =  [5.9103850439218228e-06, 1.7931048745394208e-07, 4.7290259827226129e-09]
A{4} = [4*ones(size(h')) h' L2_err']
B{4} = [4*ones(size(h')) h' energy_err'];

figure
plot_rates(A)
print(gcf,'-depsc','mixed_eps1e0.eps')


%% primal rates 1e-4
A = {}
h =  [0.25, 0.125, 0.0625, 0.03125]
energy_err =  [0.54970944252877707, 0.37613954803624816, 0.23573352887501972, 0.13024699901618536]
L2_err =  [0.22207418973061555, 0.14309748730974023, 0.09610094897216484, 0.066347150792335857]
A{1} = [1*ones(size(h')) h' L2_err'];
A{1} = A{1}(1:end-1,:);

h =  [0.25, 0.125, 0.0625, 0.03125]
energy_err =  [0.13004521553570561, 0.086360705483184322, 0.060095868316850556, 0.042179691985853786]
L2_err =  [0.11978612142999008, 0.083627409962586649, 0.058958187054914728, 0.041603766199063426]
% h =  [0.25, 0.125, 0.0625]
% energy_err =  [0.11982387104089121, 0.084827059825695245, 0.059941742471556023]
% L2_err =  [0.11916982240279116, 0.083559737192841238, 0.058945840572003007]
A{2} = [2*ones(size(h')) h' L2_err'];
A{2} = A{2}(1:end-1,:);

h =  [0.25, 0.125, 0.0625]
energy_err =  [0.088027975867592423, 0.062055412845265195, 0.0436683907683783]
L2_err =  [0.085180103665029108, 0.059934630978757571, 0.042317557314853531]
A{3} = [3*ones(size(h')) h' L2_err'];

h =  [0.25, 0.125, 0.0625]
energy_err =  [0.069651002460062797, 0.049043590471340909, 0.034360024476637115]
L2_err =  [0.066659977305886423, 0.047005392389028178, 0.033197820844903816]
A{4} = [4*ones(size(h')) h' L2_err'];

figure
plot_rates(A)
print(gcf,'-depsc','primal_eps1e4.eps')

%% mixed rates 1e-4
A = {}
% p = 1
h =  [0.25, 0.125, 0.0625, 0.03125]
dofs =  [25, 81, 289, 1089]
energy_err =  [0.18356127538649611, 0.13280491475903211, 0.094400336993274853, 0.066682046645592991]
L2_err =  [0.19357657699283076, 0.13256946651381349, 0.093228499204823775, 0.065849833687681394]
A{1} = [1*ones(size(h')) h' L2_err'];
B{1} = [1*ones(size(h')) h' energy_err'];
A{1} = A{1}(1:end-1,:);

% p = 2
h =  [0.25, 0.125, 0.0625, 0.03125]
dofs =  [81, 289, 1089, 4225]
energy_err =  [0.12166524777501632, 0.085458427164491868, 0.060156127887113095, 0.042238220883038441]
L2_err =  [0.11861657105200264, 0.083361032311205466, 0.058872840171423302, 0.041569831258883597]
A{2} = [2*ones(size(h')) h' L2_err'];
B{2} = [2*ones(size(h')) h' energy_err'];
A{2} = A{2}(1:end-1,:);

% p = 3
h =  [0.25, 0.125, 0.0625, 0.03125]
dofs =  [169, 625, 2401, 9409]
energy_err =  [0.088665601932942359, 0.06228592970970865, 0.043739101377144159, 0.030542563027370927]
L2_err =  [0.084956575604190163, 0.059854652104869635, 0.042288054881838517, 0.029772920274569556]
rates =  [0.50526223309957774, 0.5012131802007378, 0.50624946728951936]
A{3} = [3*ones(size(h')) h' L2_err'];
B{3} = [3*ones(size(h')) h' energy_err'];
A{3} = A{3}(1:end-1,:);

% p = 4
h =  [0.25, 0.125, 0.0625, 0.03125]
dofs =  [289, 1089, 4225, 16641]
energy_err =  [0.070004229072047161, 0.049163675787437862, 0.03439990921009959, 0.023829181221393155]
L2_err =  [0.066544566331099134, 0.046963626661176358, 0.033181019874742472, 0.023183892768932169]
A{4} = [4*ones(size(h')) h' L2_err'];
B{4} = [4*ones(size(h')) h' energy_err'];
A{4} = A{4}(1:end-1,:);
figure
plot_rates(A)
print(gcf,'-depsc','mixed_eps1e4.eps')

