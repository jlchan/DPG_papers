A = {}

%p = 1
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
dofs =  [25, 81, 289, 1089, 4225, 16641]
energy_err =  [0.62290703311818585, 0.27072431861901097, 0.11855826619230525, 0.054634251744383695, 0.026153527074424893, 0.012790420686002174]
L2_err =  [0.038967069740751419, 0.016225718024055171, 0.004911526881414564, 0.0013461303309777609, 0.00035389978460190398, 9.0963456010493651e-05]
rates =  [1.2639731252064927, 1.7240388218113196, 1.86735349818658, 1.927405308193896, 1.9599819104130292]
A{1} = [1*ones(size(h')) h' L2_err'];

%p = 2
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
dofs =  [81, 289, 1089, 4225, 16641, 66049]
energy_err =  [0.060047366055772551, 0.013337364622652078, 0.0031691692215455908, 0.0007739855960435557, 0.00019131191227977291, 4.7559512388127875e-05]
L2_err =  [0.0035781732948743225, 0.00042098449985414945, 5.0706575660687669e-05, 6.2098301135644413e-06, 7.676280173682021e-07, 9.5387243908665103e-08]
rates =  [3.0873842393159237, 3.0535223618880041, 3.0295471436282684, 3.0160745262276465, 3.0085391155693175]
A{2} = [2*ones(size(h')) h' L2_err'];

% p = 3
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625]
dofs =  [169, 625, 2401, 9409, 37249]
energy_err =  [0.0046152758270279291, 0.00053270276945860753, 6.2558709837172948e-05, 7.5242631527104458e-06, 9.206237908109516e-07]
L2_err =  [0.00013473809146654988, 8.6290745797277405e-06, 5.3518329880587546e-07, 3.3186001290542505e-08, 1.7488697066044276e-09]
rates =  [3.9648081122423879, 4.0111008463370723, 4.0113863861244283, 4.246080088542934]
A{3} = [3*ones(size(h')) h' L2_err'];

% p = 4
%h =  [0.25, 0.125, 0.0625]
%dofs =  [289, 1089, 4225]
%energy_err =  [0.00028604738444616354, 1.6253191470399298e-05, 9.5188502348095678e-07]
%L2_err =  [5.9204636370921941e-06, 1.7983459857573856e-07, 3.9660170263040674e-09]
%rates =  [5.0409676447372451, 5.5028359278725194]
%A{4} = [4*ones(size(h')) h' L2_err'];

h =  [0.25, 0.125, 0.0625]
energy_err =  [0.00028354955953258104, 1.6111898106875445e-05, 9.4418302714742073e-07]
L2_err =  [5.9017996483933218e-06, 1.7913353292923375e-07, 6.6282995301807784e-09]
rates =  [5.0420476124098883, 4.7562528190600473]
A{4} = [4*ones(size(h')) h' L2_err'];

plot_rates(A)
print(gcf,'-depsc','../rates/eps1e0Rates_weakBC.eps')

% makes weak outflow plot comparison - dp = 1, eps = 1e-4
L2_err =  [0.21128318788270489, 0.14356371113050378, 0.10058471883495632, 0.070967763036027295, 0.050041605677038942];
%supg_L2_err = [0.24494914631050652, 0.16193910033699388, 0.1126337435699251, 0.079379619080346284, 0.056063711874980784];
supg_L2_err = [0.24489835848639394, 0.16187059238301926, 0.11253984717309228, 0.079247911908389035, 0.055877494220933695]

weak_L2_err =  [0.045205168845910811, 0.019560804260534956, 0.012309982283722742, 0.0085375361303101759, 0.0061626237303742523];
%min_L2_err = [0.04514026489276065, 0.019609355968625963, 0.012482282897465493, 0.0088300495933000319, 0.0066590660050320624];

h =  .5*.5.^[1:length(L2_err)];


figure
set(0,'defaultlinelinewidth',1.5)
set(gca,'fontsize',14)
loglog(h,supg_L2_err,'o-')
hold on
plot(h,L2_err,'ro-')
plot(h,weak_L2_err,'ko-')
%plot(h,min_L2_err,'mo-')
xlabel('h')
ylabel('error in L^2-norm')
legend('SUPG','Strong outflow','Weak Nitsche outflow','Weak functional BC')
print(gcf,'-depsc','../rates/supg_bc_comparison.eps')