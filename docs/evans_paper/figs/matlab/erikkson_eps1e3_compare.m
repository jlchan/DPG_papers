%uniform
A = {}
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625]
dofs =  [81, 289, 1089, 4225, 16641]
energy_err =  [0.11875158046077551, 0.08211397544097622, 0.056025201753701924, 0.036935360192611753, 0.022729663931247451]
L2_err =  [0.114134429740997, 0.079697425195346561, 0.054060365560408372, 0.03443529056661232, 0.019941147308354272]
A{1} = [2*ones(size(h')) h' L2_err'];
loglog(dofs,energy_err,'b--')
hold on
plot(dofs,L2_err,'b-')

% adaptive
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125, 0.00390625, 0.001953125, 0.0009765625, 0.00048828125, 0.000244140625, 0.0001220703125, 6.103515625e-05, 3.0517578125e-05, 1.52587890625e-05, 7.62939453125e-06]
dofs =  [81, 101, 125, 156, 201, 263, 339, 458, 587, 823, 1071, 1487, 1945, 2585, 3325, 4251]
energy_err =  [0.11875158046077551, 0.084221826365210778, 0.079551284743836978, 0.058892360259576754, 0.054513630481699805, 0.041323847315001438, 0.036643450516868549, 0.027588318102592848, 0.023544649243322051, 0.017839707355087518, 0.014292882009918023, 0.010740120306351391, 0.0080947373761674022, 0.0056296947952479042, 0.0042974232328324294, 0.0025887118021980034]
L2_err =  [0.114134429740997, 0.084797397467657548, 0.077423805962697462, 0.05751667749804, 0.052917631506518348, 0.037799599696139413, 0.033945782185839123, 0.023471563648229166, 0.020071336608435412, 0.013333493362219288, 0.01040185777309484, 0.0068834918509134259, 0.00494173408819983, 0.0032767385922042231, 0.0025085378293009945, 0.0019116040656603354]

A{2} = [2*ones(size(h')) h' L2_err'];

plot(dofs,energy_err,'r--')
plot(dofs,L2_err,'r-')
legend('Energy error, uniform','L^2 error, uniform', 'Energy error, adaptive', 'L^2 error, adaptive')
set(0,'defaultlinelinewidth',2)
xlabel('Number of dofs','fontsize',15)
ylabel('Error','fontsize',15)
set(gca,'fontsize',14)

print(gcf,'-depsc','../rates/eps1e3Rates.eps')

% figure
% plot_rates(A)
