% % First order solution
% A{1} = [1 0.015625000000000 0.009092198566947
% 1 0.007812500000000   0.001941095878590
% 1 0.003906250000000   0.000472314346570
% 1 0.001953125000000   0.000115962509411];
% % Second order solution
% A{2} = [2 0.015625000000000 0.001529334669987
% 2 0.007812500000000   0.000358791388418
% 2 0.003906250000000   0.000042735296594
% 2 0.001953125000000   0.000005086547954];
% % Third order solution

A = {};
B = {};
%p = 1
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
dofs =  [25, 81, 289, 1089, 4225, 16641]
energy_err =  [0.62391839695812079, 0.27093198852142186, 0.11860978890966004, 0.054647643588877838, 0.026156972983391931, 0.012791295947786704]
L2_err =  [0.03884100820757376, 0.016230434202282751, 0.0049134167765656359, 0.0013464562177553348, 0.00035394684827656819, 9.0969768291178157e-05]

A{1} = [1*ones(size(h')) h' L2_err'];
B{1} = [1*ones(size(h')) h' energy_err'];
%p = 2
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625, 0.0078125]
dofs =  [81, 289, 1089, 4225, 16641, 66049]
energy_err =  [0.060187416538340283, 0.013358670594367367, 0.0031721466220019012, 0.00077438034042302231, 0.00019136277159742001, 4.7565968185844156e-05]
L2_err =  [0.0035834750819825245, 0.00042124666571577424, 5.0719362247134368e-05, 6.2104951756273304e-06, 7.6766236395386215e-07, 9.5391014605337451e-08]
A{2} = [2*ones(size(h')) h' L2_err']
B{2} = [2*ones(size(h')) h' energy_err'];
%p = 3
h =  [0.25, 0.125, 0.0625, 0.03125, 0.015625]
dofs =  [169, 625, 2401, 9409, 37249, 148225]
energy_err =  [0.0046347373695893711, 0.00053405163861271036, 6.2651674655232335e-05, 7.5304530812761273e-06, 9.2102469704809195e-07]
L2_err =  [0.0001353120677942511, 8.6431035919911085e-06, 5.355027608378427e-07, 3.3309862662314273e-08, 2.0001083145653167e-09]
A{3} = [3*ones(size(h')) h' L2_err']
B{3} = [3*ones(size(h')) h' energy_err'];

%p = 4
h =  [0.25, 0.125, 0.0625]
dofs =  [289, 1089, 4225]
energy_err =  [0.00028462978847489779, 1.6155890352102114e-05, 9.4580571908709627e-07]
L2_err =  [5.9103850439218228e-06, 1.7931048745394208e-07, 4.7290259827226129e-09]
A{4} = [4*ones(size(h')) h' L2_err']
B{4} = [1*ones(size(h')) h' energy_err'];

% %p = 5
% h =  [0.25, 0.125]
% dofs =  [441, 1681]
% energy_err =  [1.3140189368233047e-05, 3.8439277059823518e-07]
% L2_err =  [2.4157518938594864e-07, 3.2820199762503553e-09]
% A{5} = [5*ones(size(h')) h' L2_err']

plot_rates(A)
print(gcf,'-depsc','../rates/eps1e0Rates.eps')
%print(gcf,'-depsc',strcat(name, '_h'))
%print(gcf,'-dpng',strcat(name, '_h'))
figure;plot_rates(B);title('energy errors')
