% 12 refs, p = 2, dp = 1, initial N = 4, 1e-1 to 1e-6
col = hsv(4)

figure;

% eps = 1e-1
dofs =  [81, 101, 123, 161, 215, 275, 362, 487, 647, 863, 1107, 1487]
energy_err =  [0.021344425999369088, 0.014671388933453074, 0.009557888653306125, 0.0070403222566920078, 0.0047305170183488286, 0.0033060997581671561, 0.0028892553460036366, 0.0021966547001102035, 0.0016354715319096885, 0.0010974187844634989, 0.00079549466207076236, 0.00065871105480293528]
L2_err =  [0.0056780043089128289, 0.0034706770640939239, 0.0016379529164242017, 0.001304892934393522, 0.00083520275443114305, 0.00066987950540410503, 0.00043601824651183822, 0.00026107529378567866, 0.00017329730328500799, 9.8231145926459164e-05, 6.9429297815698252e-05, 4.0536984443571555e-05]

i = 1
loglog(dofs,L2_err,'-','color',col(i,:))
hold on
loglog(dofs,energy_err,'--','color',col(i,:))

% eps = 1e-2
dofs =  [81, 101, 125, 156, 194, 249, 316, 411, 529, 671, 851, 1061]
energy_err =  [0.093330885398702684, 0.068292508828105808, 0.053559612568761183, 0.041494742056516702, 0.028765811722545671, 0.023325251679290893, 0.014596642446867238, 0.010938959838637866, 0.0073188268909461906, 0.0044002086541261179, 0.0034239111874826912, 0.0020796772369217598]
L2_err =  [0.085168306170146313, 0.05531942302345938, 0.043046308032743036, 0.027903092143619319, 0.018121449064513673, 0.012418633159924964, 0.0069965433479323184, 0.0044483536173308899, 0.0029550423907497374, 0.0015226588633130767, 0.0012201946669860568, 0.00094417590943984733]

i = 2
loglog(dofs,L2_err,'-','color',col(i,:))
hold on
loglog(dofs,energy_err,'--','color',col(i,:))

% eps = 1e-3
dofs =  [81, 101, 125, 156, 201, 263, 339, 458, 587, 823, 1071, 1483]
energy_err =  [0.11874932452273096, 0.084036842503426717, 0.079527481763835811, 0.058866391304556391, 0.054473696746919466, 0.041318896353905891, 0.036642257650252544, 0.02758650440903811, 0.023541723650921005, 0.017836091385970556, 0.014289643652336922, 0.010800333746031546]
L2_err =  [0.11719792153207896, 0.086016583777958816, 0.078478791815125432, 0.057682532391197923, 0.053075128754830066, 0.037812526998103245, 0.033941384531053484, 0.023470395107156362, 0.020075100332953111, 0.013335736070392689, 0.010401412495344943, 0.0069402187159727253]

i = 3
loglog(dofs,L2_err,'-','color',col(i,:))
hold on
loglog(dofs,energy_err,'--','color',col(i,:))

% eps = 1e-4
dofs =  [81, 101, 125, 156, 201, 263, 339, 461, 615, 869, 1137, 1649]
energy_err =  [0.121665221609131, 0.085666280577609652, 0.082665597314132519, 0.059453073100573149, 0.057848313925423042, 0.042237824983464359, 0.040886777794183836, 0.029949913971603168, 0.028895177259539606, 0.021247370816898908, 0.020259470440493078, 0.015030875997936633]
L2_err =  [0.11861657343936373, 0.089596087019849752, 0.081874126289953317, 0.066802846068710356, 0.060205609978140007, 0.047271327140893292, 0.042784660195255841, 0.03233445636982734, 0.030083134741331723, 0.021464792607370987, 0.020244738690146799, 0.014159399704709677]

i = 4
loglog(dofs,L2_err,'o-','color',col(i,:))
hold on
loglog(dofs,energy_err,'s--','color',col(i,:))

set(0,'defaultlinelinewidth',2)
xlabel('Number of dofs','fontsize',15)
ylabel('Error','fontsize',15)
set(gca,'fontsize',14)

legNames={}
for i = 1:4
    legNames{2*i-1} = ['L^2, 10^{-' num2str(i) '}'];
    legNames{2*i} = ['Energy, 10^{-' num2str(i) '}'];
end
legend(legNames)
%print(gcf,'-depsc','../epsRangeComparison.eps')

